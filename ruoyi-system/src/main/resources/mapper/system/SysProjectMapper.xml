<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ruoyi.system.mapper.SysProjectMapper">

    <resultMap id="SysProjectResult" type="DatahouseProject">
        <id     property="projectId"            column="project_id"         />
        <result property="projectName"          column="project_name"       />
        <result property="createTime"           column="create_time"        />
        <result property="remark"               column="remark"             />
    </resultMap>


    <select id="selectProject" parameterType="DatahouseProject" resultMap="SysProjectResult">
        select * from datahouse_project
        <where>
            <if test="projectId != null and projectId != ''">
                AND project_id like concat('%', #{projectId}, '%')
            </if>
            <if test="projectName != null and projectName != ''">
                AND project_name like concat('%', #{projectName}, '%')
            </if>
        </where>
    </select>

    <delete id="deleteProjectByIds" parameterType="Long">
        delete from datahouse_project where project_id in
        <foreach item="projectId" collection="array" open="(" separator="," close=")">
            #{projectId}
        </foreach>
    </delete>

    <update id="updateAfterDelete" parameterType="java.lang.Integer">
        alter table datahouse_project AUTO_INCREMENT=1
    </update>

    <update id="updateAfter" parameterType="java.lang.Integer">
        update datahouse_project
        set project_id = project_id-1
        where project_id > 1 and project_id > #{projectId,jdbcType=INTEGER}
    </update>

    <insert id="insertProject" parameterType="DatahouseProject" keyProperty="projectId">
        insert into datahouse_project(
            <if test="projectId != null and projectId != 0">project_id,</if>
            <if test="projectName != null and projectName != '' ">project_name, </if>
            <if test="remark != null and remark != '' ">remark, </if>
            create_time
        )values(
            <if test="projectId != null and projectId != 0">#{projectId},</if>
            <if test="projectName != null and projectName != '' ">#{projectName}, </if>
            <if test="remark != null and remark != '' ">#{remark}, </if>
            sysdate()
        )
    </insert>

    <select id="selectProjectById" parameterType="Long" resultMap="SysProjectResult">
        select * from datahouse_project where project_id = #{projectId}
    </select>

    <update id="updateProject" parameterType="DatahouseProject">
        update datahouse_project
        <set>
            <if test="projectName != null and projectName != ''">project_name = #{projectName}, </if>
            <if test="remark != null and remark != ''">remark = #{remark}, </if>
        </set>
        where project_id = #{projectId}
    </update>

</mapper>